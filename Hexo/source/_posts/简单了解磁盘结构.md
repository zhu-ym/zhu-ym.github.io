---
title: 简单了解磁盘
typora-root-url: ../
date: 2021-01-03 11:05:42
tags:
 - 磁盘管理
categories:
 - [操作系统,现代操作系统]
---

简单介绍一些磁盘的结构、并了解一些磁盘调度算法

<!--more-->

# 磁盘结构

磁盘结构示意图如下：

![image-20210103111225607](/images/image-20210103111225607.png)

磁盘有一个或多个**盘片**，用于存储数据。盘片多采用铝合金材料；中间有一个**主轴**，所有的盘片都绕着这个主轴转动。一个组合臂上面有多个**磁头臂**，每个磁头臂上面都有一个**磁头**，负责读写数据。

当磁头臂移动（**寻道**）处于不同位置时，会纵向上会组织成一个**柱面**，同时盘边上的同心圆环就称为**磁道**，一个磁道又可以划分成多个**扇区**。有的磁头总是在盘片上面，关机时，磁头停在盘片上面，抖动容易划伤盘面造成数据损失，为了避免这样的情况，所以磁头都是停留在没有数据启停区，而有的磁头，启停区就在盘片外面。

磁盘被**磁盘控制器**所控制（可控制一个或多个），它是一个小处理器，可以完成一些特定的工作。比如将磁头定位到一个特定的半径位置；从磁头所在的柱面选择一个扇区；读取数据等。

![image-20210103113239890](/images/image-20210103113239890.png)

# 磁盘访问加速

磁盘访问和内存访问差距很大，需要对其进行加速、优化

## 并行I/O (RAID)

RAID （ Redundant Array of Independent Disks ）即独立磁盘冗余阵列，通常简称为磁盘阵列。简单地说， RAID 是由多个独立的高性能磁盘驱动器组成的磁盘子系统，从而提供比单个磁盘更高的存储性能和数据冗余的技术。单个磁盘的 I/O 性能受到接口、带宽等计算机技术的限制，性能往往很有 限，容易成为系统性能的瓶颈。通过数据条带化， RAID 将数据 I/O 分散到各个成员磁盘上，从而获得比单个磁盘成倍增长的聚合 I/O 性能。

## 磁盘臂调度算法

读取一个磁盘块的时间由三个元素决定

- **寻道时间：**磁盘臂移动到合适柱面所需时间
- **旋转延迟：**扇区转到磁头下所需时间
- **实际数据传输时间**

一般来说，寻道时间占主导地位，优化寻道时间可以改善访问性能

主要有以下算法优化磁盘臂调度

- **先到先服务（FCFS）**：按照磁盘请求的顺序进行调度。优点是公平和简单，但很难优化寻道时间
- **最短寻道优先（SSF）：**下一次处理与磁头距离最小的柱面。优点是平均寻道时间短，但磁盘负担重时，很容易让磁盘臂停留在磁盘的中部区域，两端极端区域请求饥饿
- **电梯算法：**类似电梯总是一个方向运行，直到该方向没有请求为止，然后改变运行方向。兼顾效率和公平

## 其他

前面在文件系统说到的三种方法，**高速缓存、块提取读、按柱面组织数据（减少磁盘臂运动）**

这里特别强调一个**磁盘控制器的高速缓存**，与前面使用内存、操作系统的高速缓存进行区分，两者完全独立：

由于寻道和旋转影响性能，一次只读取一两个扇区效率非常低下，于是当请求扇区时，磁盘控制器总是读取多个扇区并进行高速缓存，这里的高速缓存区是在磁盘上，最简单可以分为读写两个区段

其和操作系统的高速缓存有明显区别：一是**高速缓存位置**，二是**高速缓存的块是否被请求**：操作系统的任何高速缓存由显式读出的块组成，认为其很近的将来会被需要，而磁盘的高速缓存只是恰巧经过